(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[531],{2603:function(H,D,e){"use strict";e.d(D,{Z:function(){return L}});var y=e(28991),g=e(67294),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"},M=A,r=e(13401),s=function(F,I){return g.createElement(r.Z,(0,y.Z)((0,y.Z)({},F),{},{ref:I,icon:M}))},l=g.forwardRef(s),L=l},29985:function(H,D,e){"use strict";e.d(D,{Z:function(){return L}});var y=e(28991),g=e(67294),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},M=A,r=e(13401),s=function(F,I){return g.createElement(r.Z,(0,y.Z)((0,y.Z)({},F),{},{ref:I,icon:M}))},l=g.forwardRef(s),L=l},16434:function(H,D,e){"use strict";var y=e(57663),g=e(71577),A=e(47673),M=e(4107),r=e(28991),s=e(7353),l=e(92137),L=e(81253),B=e(28481),F=e(9715),I=e(55843),p=e(85893),O=e(67294),i=e(41701),V=["rules","name","phoneName","fieldProps","captchaTextRender","captchaProps"],w=O.forwardRef(function(b,a){var re=I.Z.useFormInstance(),de=(0,O.useState)(b.countDown||60),ce=(0,B.Z)(de,2),fe=ce[0],me=ce[1],Ze=(0,O.useState)(!1),te=(0,B.Z)(Ze,2),_=te[0],$=te[1],ne=(0,O.useState)(),se=(0,B.Z)(ne,2),ve=se[0],k=se[1],Ee=b.rules,ge=b.name,q=b.phoneName,z=b.fieldProps,le=b.captchaTextRender,u=le===void 0?function(T,f){return T?"".concat(f," \u79D2\u540E\u91CD\u65B0\u83B7\u53D6"):"\u83B7\u53D6\u9A8C\u8BC1\u7801"}:le,pe=b.captchaProps,he=(0,L.Z)(b,V),J=function(){var T=(0,l.Z)((0,s.Z)().mark(function f(W){return(0,s.Z)().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.prev=0,k(!0),Z.next=4,he.onGetCaptcha(W);case 4:k(!1),$(!0),Z.next=13;break;case 8:Z.prev=8,Z.t0=Z.catch(0),$(!1),k(!1),console.log(Z.t0);case 13:case"end":return Z.stop()}},f,null,[[0,8]])}));return function(W){return T.apply(this,arguments)}}();return(0,O.useImperativeHandle)(a,function(){return{startTiming:function(){return $(!0)},endTiming:function(){return $(!1)}}}),(0,O.useEffect)(function(){var T=0,f=b.countDown;return _&&(T=window.setInterval(function(){me(function(W){return W<=1?($(!1),clearInterval(T),f||60):W-1})},1e3)),function(){return clearInterval(T)}},[_]),(0,p.jsxs)("div",{style:(0,r.Z)((0,r.Z)({},z==null?void 0:z.style),{},{display:"flex",alignItems:"center"}),ref:a,children:[(0,p.jsx)(M.Z,(0,r.Z)((0,r.Z)({},z),{},{style:{flex:1,transition:"width .3s",marginRight:8}})),(0,p.jsx)(g.Z,(0,r.Z)((0,r.Z)({style:{display:"block"},disabled:_,loading:ve},pe),{},{onClick:function(){var T=(0,l.Z)((0,s.Z)().mark(function W(){var ee;return(0,s.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(m.prev=0,!q){m.next=9;break}return m.next=4,re.validateFields([q].flat(1));case 4:return ee=re.getFieldValue([q].flat(1)),m.next=7,J(ee);case 7:m.next=11;break;case 9:return m.next=11,J("");case 11:m.next=16;break;case 13:m.prev=13,m.t0=m.catch(0),console.log(m.t0);case 16:case"end":return m.stop()}},W,null,[[0,13]])}));function f(){return T.apply(this,arguments)}return f}(),children:u(_,fe)}))]})}),o=(0,i.G)(w);D.Z=o},5966:function(H,D,e){"use strict";var y=e(28991),g=e(81253),A=e(85893),M=e(2904),r=["fieldProps","proFieldProps"],s=["fieldProps","proFieldProps"],l="text",L=function(p){var O=p.fieldProps,i=p.proFieldProps,V=(0,g.Z)(p,r);return(0,A.jsx)(M.Z,(0,y.Z)({valueType:l,fieldProps:O,filedConfig:{valueType:l},proFieldProps:i},V))},B=function(p){var O=p.fieldProps,i=p.proFieldProps,V=(0,g.Z)(p,s);return(0,A.jsx)(M.Z,(0,y.Z)({valueType:"password",fieldProps:O,proFieldProps:i,filedConfig:{valueType:l}},V))},F=L;F.Password=B,F.displayName="ProFormComponent",D.Z=F},34687:function(H){H.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",icon:"icon___rzGKO"}},32384:function(){},13076:function(H,D,e){"use strict";e.r(D),e.d(D,{default:function(){return Fe}});var y=e(18106),g=e(25499),A=e(34792),M=e(48086),r=e(39428),s=e(11849),l=e(3182),L=e(2824),B=e(17462),F=e(76772),I=e(89366),p=e(2603),O=e(29985),i=e(67294),V=e(84305),w=e(88182),o=e(28991),b=e(81253),a=e(85893),re=e(78775),de=e(5894),ce=e(32384),fe=["logo","message","contentStyle","title","subTitle","actions","children"];function me(t){var h,d=t.logo,U=t.message,R=t.contentStyle,G=t.title,K=t.subTitle,Y=t.actions,Pe=t.children,E=(0,b.Z)(t,fe),Q=(0,re.YB)(),oe=E.submitter===!1?!1:(0,o.Z)((0,o.Z)({searchConfig:{submitText:Q.getMessage("loginForm.submitText","\u767B\u5F55")}},E.submitter),{},{submitButtonProps:(0,o.Z)({size:"large",style:{width:"100%"}},(h=E.submitter)===null||h===void 0?void 0:h.submitButtonProps),render:function(X,S){var c,C=S.pop();if(typeof(E==null||(c=E.submitter)===null||c===void 0?void 0:c.render)=="function"){var v,P;return E==null||(v=E.submitter)===null||v===void 0||(P=v.render)===null||P===void 0?void 0:P.call(v,X,S)}return C}}),Me=(0,i.useContext)(w.ZP.ConfigContext),x=Me.getPrefixCls("pro-form-login"),N=function(X){return"".concat(x,"-").concat(X)},ae=(0,i.useMemo)(function(){return d?typeof d=="string"?(0,a.jsx)("img",{src:d}):d:null},[d]);return(0,a.jsxs)("div",{className:N("container"),children:[(0,a.jsxs)("div",{className:N("top"),children:[G||ae?(0,a.jsxs)("div",{className:N("header"),children:[ae?(0,a.jsx)("span",{className:N("logo"),children:ae}):null,G?(0,a.jsx)("span",{className:N("title"),children:G}):null]}):null,K?(0,a.jsx)("div",{className:N("desc"),children:K}):null]}),(0,a.jsxs)("div",{className:N("main"),style:(0,o.Z)({width:328},R),children:[(0,a.jsxs)(de.A,(0,o.Z)((0,o.Z)({isKeyPressSubmit:!0},E),{},{submitter:oe,children:[U,Pe]})),Y?(0,a.jsx)("div",{className:N("other"),children:Y}):null]})]})}var Ze=e(63185),te=e(9676),_=e(22270),$=e(41701),ne=e(2904),se=["options","fieldProps","proFieldProps","valueEnum"],ve=i.forwardRef(function(t,h){var d=t.options,U=t.fieldProps,R=t.proFieldProps,G=t.valueEnum,K=(0,b.Z)(t,se);return(0,a.jsx)(ne.Z,(0,o.Z)({ref:h,valueType:"checkbox",valueEnum:(0,_.h)(G,void 0),fieldProps:(0,o.Z)({options:d},U),lightProps:(0,o.Z)({labelFormatter:function(){return(0,a.jsx)(ne.Z,(0,o.Z)({ref:h,valueType:"checkbox",mode:"read",valueEnum:(0,_.h)(G,void 0),filedConfig:{customLightMode:!0},fieldProps:(0,o.Z)({options:d},U),proFieldProps:R},K))}},K.lightProps),proFieldProps:R},K))}),k=i.forwardRef(function(t,h){var d=t.fieldProps,U=t.children;return(0,a.jsx)(te.Z,(0,o.Z)((0,o.Z)({ref:h},d),{},{children:U}))}),Ee=(0,$.G)(k,{valuePropName:"checked"}),ge=Ee;ge.Group=ve;var q=ge,z=e(5966),le=e(16434),u=e(21010),pe=e(92002);function he(t,h){return J.apply(this,arguments)}function J(){return J=(0,l.Z)((0,r.Z)().mark(function t(h,d){return(0,r.Z)().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.abrupt("return",(0,u.WY)("/api/login/captcha",(0,s.Z)({method:"GET",params:(0,s.Z)({},h)},d||{})));case 1:case"end":return R.stop()}},t)})),J.apply(this,arguments)}var T=e(34687),f=e.n(T),W=e(30274),ee=e(53313),Z=function(h){var d=h.content;return(0,a.jsx)(F.Z,{style:{marginBottom:24},message:d,type:"error",showIcon:!0})},m=function(){var h=(0,i.useState)({}),d=(0,L.Z)(h,2),U=d[0],R=d[1],G=(0,i.useState)("account"),K=(0,L.Z)(G,2),Y=K[0],Pe=K[1],E=(0,u.tT)("@@initialState"),Q=E.initialState,oe=E.setInitialState,Me=E.refresh,x=(0,u.YB)(),N=function(){var S=(0,l.Z)((0,r.Z)().mark(function c(){var C,v;return(0,r.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Q==null||(C=Q.fetchUserInfo)===null||C===void 0?void 0:C.call(Q);case 2:if(v=n.sent,!v){n.next=6;break}return n.next=6,oe(function(ue){return(0,s.Z)((0,s.Z)({},ue),{},{currentUser:v})});case 6:case"end":return n.stop()}},c)}));return function(){return S.apply(this,arguments)}}(),ae=function(){var S=(0,l.Z)((0,r.Z)().mark(function c(C){var v,P,n,ue,xe,Ce,je,ye;return(0,r.Z)().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.prev=0,j.next=3,(0,W.y)(C);case 3:if(v=j.sent,P=v.data,n=v.response,console.log(P,n,n.status),n.status!==200){j.next=20;break}if(ue=n.headers.get("authorization"),xe=x.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),(0,ee.F_)(ue),oe(function(Oe){return(0,s.Z)((0,s.Z)({},Oe),{},{currentUser:P})}),M.default.success(xe),u.m8){j.next=15;break}return j.abrupt("return");case 15:return Ce=u.m8.location.query,je=Ce.redirect,u.m8.push(je||"/"),Me(),j.abrupt("return");case 20:R(P),j.next=27;break;case 23:j.prev=23,j.t0=j.catch(0),ye=x.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),M.default.error(ye);case 27:case"end":return j.stop()}},c,null,[[0,23]])}));return function(C){return S.apply(this,arguments)}}(),ie=U.status,X=U.type;return(0,a.jsxs)("div",{className:f().container,children:[(0,a.jsx)("div",{className:f().lang,"data-lang":!0,children:u.pD&&(0,a.jsx)(u.pD,{})}),(0,a.jsx)("div",{className:f().content,children:(0,a.jsxs)(me,{logo:(0,a.jsx)("img",{alt:"logo",src:"/logo.png"}),title:"Digit Ant",subTitle:x.formatMessage({id:"pages.layouts.userLayout.title",default:""}),initialValues:{autoLogin:!0},onFinish:function(){var S=(0,l.Z)((0,r.Z)().mark(function c(C){return(0,r.Z)().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,ae(C);case 2:case"end":return P.stop()}},c)}));return function(c){return S.apply(this,arguments)}}(),children:[(0,a.jsxs)(g.Z,{activeKey:Y,onChange:Pe,children:[(0,a.jsx)(g.Z.TabPane,{tab:x.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})},"account"),(0,a.jsx)(g.Z.TabPane,{tab:x.formatMessage({id:"pages.login.phoneLogin.tab",defaultMessage:"\u624B\u673A\u53F7\u767B\u5F55"})},"mobile")]}),ie==="error"&&X==="account"&&(0,a.jsx)(Z,{content:x.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),Y==="account"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.Z,{name:"username",fieldProps:{size:"large",prefix:(0,a.jsx)(I.Z,{className:f().prefixIcon})},placeholder:x.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,a.jsx)(u._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,a.jsx)(z.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,a.jsx)(p.Z,{className:f().prefixIcon})},placeholder:x.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,a.jsx)(u._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),ie==="error"&&X==="mobile"&&(0,a.jsx)(Z,{content:"\u9A8C\u8BC1\u7801\u9519\u8BEF"}),Y==="mobile"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(z.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(O.Z,{className:f().prefixIcon})},name:"mobile",placeholder:x.formatMessage({id:"pages.login.phoneNumber.placeholder",defaultMessage:"\u624B\u673A\u53F7"}),rules:[{required:!0,message:(0,a.jsx)(u._H,{id:"pages.login.phoneNumber.required",defaultMessage:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\uFF01"})},{pattern:/^1\d{10}$/,message:(0,a.jsx)(u._H,{id:"pages.login.phoneNumber.invalid",defaultMessage:"\u624B\u673A\u53F7\u683C\u5F0F\u9519\u8BEF\uFF01"})}]}),(0,a.jsx)(le.Z,{fieldProps:{size:"large",prefix:(0,a.jsx)(p.Z,{className:f().prefixIcon})},captchaProps:{size:"large"},placeholder:x.formatMessage({id:"pages.login.captcha.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}),captchaTextRender:function(c,C){return c?"".concat(C," ").concat(x.formatMessage({id:"pages.getCaptchaSecondText",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})):x.formatMessage({id:"pages.login.phoneLogin.getVerificationCode",defaultMessage:"\u83B7\u53D6\u9A8C\u8BC1\u7801"})},name:"captcha",rules:[{required:!0,message:(0,a.jsx)(u._H,{id:"pages.login.captcha.required",defaultMessage:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801\uFF01"})}],onGetCaptcha:function(){var S=(0,l.Z)((0,r.Z)().mark(function c(C){var v;return(0,r.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,he({phone:C});case 2:if(v=n.sent,v!==!1){n.next=5;break}return n.abrupt("return");case 5:M.default.success("\u83B7\u53D6\u9A8C\u8BC1\u7801\u6210\u529F\uFF01\u9A8C\u8BC1\u7801\u4E3A\uFF1A1234");case 6:case"end":return n.stop()}},c)}));return function(c){return S.apply(this,arguments)}}()})]}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)(q,{noStyle:!0,name:"autoLogin",children:(0,a.jsx)(u._H,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,a.jsx)("a",{style:{float:"right"},children:(0,a.jsx)(u._H,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,a.jsx)(pe.Z,{})]})},Fe=m},30274:function(H,D,e){"use strict";e.d(D,{y:function(){return L}});var y=e(39428),g=e(34792),A=e(48086),M=e(3182),r=e(11614),s=e(21010),l="/login/v1";function L(F,I){return B.apply(this,arguments)}function B(){return B=(0,M.Z)((0,y.Z)().mark(function F(I,p){return(0,y.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,s.WY)("https://mdc-api.bitcode-lab.com"+l+"/username_login",{getResponse:!0,method:"POST",headers:{"Content-Type":"application/json"},data:I,errorHandler:function(w){var o=w.data;return A.default.error(o.message),o}}));case 1:case"end":return i.stop()}},F)})),B.apply(this,arguments)}}}]);
